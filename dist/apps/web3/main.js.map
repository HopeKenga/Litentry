{"version":3,"file":"main.js","mappings":"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","sources":["webpack://interview/./apps/web3/src/app/app.controller.ts","webpack://interview/./apps/web3/src/app/app.module.ts","webpack://interview/./apps/web3/src/app/app.service.ts","webpack://interview/./libs/auth/src/index.ts","webpack://interview/./libs/auth/src/jwt.strategy.ts","webpack://interview/./libs/auth/src/lib/auth.controller.ts","webpack://interview/./libs/auth/src/lib/auth.module.ts","webpack://interview/./libs/auth/src/lib/auth.service.ts","webpack://interview/./libs/auth/src/lib/constants.ts","webpack://interview/./libs/auth/src/lib/jwt-auth.guard.ts","webpack://interview/./libs/auth/src/lib/local-auth.guard.ts","webpack://interview/./libs/auth/src/local.strategy.ts","webpack://interview/./libs/challengecode/src/index.ts","webpack://interview/./libs/challengecode/src/lib/challengecode.controller.ts","webpack://interview/./libs/challengecode/src/lib/challengecode.module.ts","webpack://interview/./libs/challengecode/src/lib/challengecode.service.ts","webpack://interview/./libs/d-auth/src/index.ts","webpack://interview/./libs/d-auth/src/lib/d-auth.controller.ts","webpack://interview/./libs/d-auth/src/lib/d-auth.module.ts","webpack://interview/./libs/d-auth/src/lib/d-auth.service.ts","webpack://interview/./libs/user/src/dto/register.dto.ts","webpack://interview/./libs/user/src/index.ts","webpack://interview/./libs/user/src/lib/user.controller.ts","webpack://interview/./libs/user/src/lib/user.module.ts","webpack://interview/./libs/user/src/lib/user.service.ts","webpack://interview/external commonjs \"@nestjs/common\"","webpack://interview/external commonjs \"@nestjs/core\"","webpack://interview/external commonjs \"@nestjs/jwt\"","webpack://interview/external commonjs \"@nestjs/passport\"","webpack://interview/external commonjs \"@polkadot/util\"","webpack://interview/external commonjs \"@polkadot/util-crypto\"","webpack://interview/external commonjs \"@prisma/client\"","webpack://interview/external commonjs \"bcrypt\"","webpack://interview/external commonjs \"class-validator\"","webpack://interview/external commonjs \"express\"","webpack://interview/external commonjs \"passport-jwt\"","webpack://interview/external commonjs \"passport-local\"","webpack://interview/external commonjs \"tslib\"","webpack://interview/webpack/bootstrap","webpack://interview/./apps/web3/src/main.ts"],"sourcesContent":["import { Controller, Get } from '@nestjs/common';\n\nimport { AppService } from './app.service';\n\n@Controller()\nexport class AppController {\n  constructor(private readonly appService: AppService) {}\n\n  @Get()\n  getData() {\n    return this.appService.getData();\n  }\n}\n","import { ChallengecodeModule } from '@interview/challengecode';\nimport { DAuthModule } from '@interview/d-auth';\nimport { Module } from '@nestjs/common';\n\nimport { AppController } from './app.controller';\nimport { AppService } from './app.service';\n\n@Module({\n  imports: [\n    DAuthModule,\n    ChallengecodeModule,\n  ],\n  controllers: [AppController],\n  providers: [AppService],\n})\nexport class AppModule {}\n","import { Injectable } from '@nestjs/common';\n\n@Injectable()\nexport class AppService {\n  getData(): { message: string } {\n    return { message: 'Welcome to web3!' };\n  }\n}\n","export * from './lib/auth.controller';\nexport * from './lib/auth.service';\nexport * from './lib/auth.module';\n","import { PassportStrategy } from \"@nestjs/passport\";\nimport { ExtractJwt, Strategy } from \"passport-jwt\";\nimport { jwtConstants } from './lib/constants';\n\nexport class JwtStrategy extends PassportStrategy(Strategy) {\n    constructor() {\n        super({\n            jwtFromRequest: ExtractJwt.fromAuthHeaderAsBearerToken(),\n            ignoreExpiration: false,\n            secretOrKey: jwtConstants.secret\n        })\n    }\n\n    async validate(payload: any) {\n        return {userId: payload.sub, username: payload.username}\n    }\n}\n//validation . \n//extending the passport strategy.","import { Controller } from '@nestjs/common';\nimport { AuthService } from './auth.service';\n\n@Controller('auth')\nexport class AuthController {\n  constructor(private authService: AuthService) {}\n}\n","import { Module } from '@nestjs/common';\nimport { JwtModule } from '@nestjs/jwt';\nimport { PassportModule } from '@nestjs/passport';\n\nimport { AuthController } from './auth.controller';\nimport { AuthService } from './auth.service';\nimport { jwtConstants } from './constants';\nimport { JwtStrategy } from '../jwt.strategy';\nimport { LocalStrategy } from '../local.strategy';\nimport { LocalAuthGuard } from './local-auth.guard';\nimport { JwtAuthGuard } from './jwt-auth.guard';\n@Module({\n  imports: [\n    PassportModule,\n    JwtModule.register({\n      secret: jwtConstants.secret,\n      signOptions: { expiresIn: '6000s' },\n    }),\n  ],\n  controllers: [AuthController],\n  providers: [AuthService, LocalStrategy, JwtStrategy, LocalAuthGuard, JwtAuthGuard],\n  exports: [AuthService, LocalStrategy, JwtStrategy, LocalAuthGuard, JwtAuthGuard],\n})\nexport class AuthModule {}\n","import { Injectable } from '@nestjs/common';\nimport { JwtService } from '@nestjs/jwt';\nimport { Prisma, PrismaClient, User } from '@prisma/client';\nimport * as bcrypt from 'bcrypt';\n\nconst prisma = new PrismaClient();\n@Injectable()\nexport class AuthService {\n    constructor(\n        private jwtTokenService: JwtService,\n    ) {}\n    async loginWithCredentials(user: User): Promise<string> {\n        const payload = { username: user.username, sub: user.id };\n        const accessToken = this.jwtTokenService.sign(payload);\n        return accessToken;\n    } \n\n    public async validateUserCredentials(username: string, password: string): Promise<User> {\n        const user = await prisma.user.findUnique({\n            where: {\n                username: username,\n            }\n        });\n        if (user && await bcrypt.compare(password, user.password)) {\n            const {...result } = user;\n            return result;\n        }\n    }\n}\n","export const jwtConstants = {\n    secret: process.env.JWT_SECRET || 'secretKey',\n}","import { Injectable } from \"@nestjs/common\";\nimport { AuthGuard } from \"@nestjs/passport\";\n\n@Injectable()\nexport class JwtAuthGuard extends AuthGuard('jwt') {} \n//guards for authentication.","import { Injectable } from '@nestjs/common';\nimport { AuthGuard } from '@nestjs/passport';\n\n@Injectable()\nexport class LocalAuthGuard extends AuthGuard('local') {}","import { Injectable, UnauthorizedException } from \"@nestjs/common\";\nimport { PassportStrategy } from \"@nestjs/passport\";\nimport { Strategy } from \"passport-local\";\nimport { AuthService } from \"./lib/auth.service\";\n\n@Injectable()\nexport class LocalStrategy extends PassportStrategy(Strategy) {\n    constructor(\n        private authService: AuthService,\n    ) {\n        super({\n            usernameField: \"username\",\n        });\n    }\n\n    async validate(username: string, password: string): Promise<any> {\n        const user = await this.authService.validateUserCredentials(username, password);\n        console.log('user', user);\n\n        if (!user) {\n            throw new UnauthorizedException('Invalid credentials, user not found');\n        }\n\n        return user;\n    }\n}\n//local strategy is used for login\n//jwt is for all other authentications(session based authentication through provision of an accessToken)","export * from './lib/challengecode.controller';\nexport * from './lib/challengecode.service';\nexport * from './lib/challengecode.module';\n","import { Body, Controller, Post } from '@nestjs/common';\nimport { ChallengecodeService } from './challengecode.service';\n\n@Controller('v1')\nexport class ChallengecodeController {\n  constructor(private challengecodeService: ChallengecodeService) {}\n  @Post('challengecode')\n  async getChallengeCode(@Body() req: {address: string}) {\n    const {address} = req\n    return await this.challengecodeService.getChallengeCode(address);\n  }\n}\n","import { Module } from '@nestjs/common';\nimport { ChallengecodeController } from './challengecode.controller';\nimport { ChallengecodeService } from './challengecode.service';\n\n@Module({\n  controllers: [ChallengecodeController],\n  providers: [ChallengecodeService],\n  exports: [ChallengecodeService],\n})\nexport class ChallengecodeModule {}\n","import { Injectable } from '@nestjs/common';\nimport { PrismaClient } from '@prisma/client';\n\nconst prisma = new PrismaClient();\n\n@Injectable()\nexport class ChallengecodeService {\n    public async getChallengeCode(address) {\n        //check if a challenge code exists\n        const verifyChallenge = await this.verifyChallengeCode(address);\n        if(verifyChallenge === false) {\n            //add a new challenge code\n            return this.addChallenge(address);\n        }\n        //return the challenge code\n        const result = await prisma.challenge.findFirst({\n            where: {\n                usedAt: null,\n                requester: address\n            }\n        })\n        return result;\n    }\n\n    private async verifyChallengeCode(address:string): Promise<boolean> {\n        //check if challengecode is valid\n        const result = await prisma.challenge.findFirst({\n            where: {\n                usedAt: null,\n                requester: address\n            }\n        })\n\n        if(result) {\n            //check if challengecode is expired after 5 minutes\n            const now = new Date();\n            const createdAt = new Date(result.createdAt);\n            let diff = (now.getTime() - createdAt.getTime()) / 1000;\n            diff /= 60;\n            const minutes = Math.abs(Math.round(diff));\n            if(minutes > 3) {\n                //update challengecode to expired\n                await prisma.challenge.update({\n                    where: {\n                        id: result.id\n                    },\n                    data: {\n                        usedAt: new Date()\n                    }\n                });\n                return false;\n            }\n            return true;\n        }\n        return false;\n    }\n\n    private async addChallenge(address: string) {\n        //make a random string\n        const challenge = Math.random().toString(36).substring(2, 15) + Math.random().toString(36).substring(2, 15);\n        const addChallenge = {\n            challenge: challenge,\n            requester: address\n        }\n\n        //store the challenge in the database\n        const result = await prisma.challenge.create({\n            data: addChallenge\n        });\n\n        return result;\n    }\n}\n","export * from './lib/d-auth.controller';\nexport * from './lib/d-auth.service';\nexport * from './lib/d-auth.module';\n","import { AuthService } from '@interview/auth';\nimport { UserService } from '@interview/user';\nimport { Body, Controller, Get, HttpStatus, Post, Response, UseGuards } from '@nestjs/common';\nimport { AuthGuard } from '@nestjs/passport';\nimport { DAuthService } from './d-auth.service';\n\n@Controller('v1')\nexport class DAuthController {\n  constructor(\n    private dAuthService: DAuthService,\n    private authService: AuthService,\n    private userService: UserService,\n  ) {}\n\n  @Post('signin')\n  async signin(@Body() params:any, @Response() res) {\n    const isValid = await this.dAuthService.signin(params);\n    // return isValid;\n    if(isValid === true) {\n      const token = await this.authService.loginWithCredentials(params.username);\n      return res.status(HttpStatus.OK).json({\n        message: 'Login successful',\n        access_token: token,\n        user: params.username\n      });\n    } else {\n      return res.status(HttpStatus.UNAUTHORIZED).json({\n        statusCode: HttpStatus.UNAUTHORIZED,\n        message: 'Invalid signature'\n      });\n    }\n  }\n\n  @Post('signin-task3')\n  async signinTask3(@Body() params:any, @Response() res) {\n    const isValid = await this.dAuthService.signinTask3(params);\n    // return isValid;\n    if(isValid === true) {\n      const token = await this.authService.loginWithCredentials(params.username);\n      return res.status(HttpStatus.OK).json({\n        message: 'Login successful',\n        access_token: token,\n        user: params.username\n      });\n    } else {\n      return res.status(HttpStatus.UNAUTHORIZED).json({\n        statusCode: HttpStatus.UNAUTHORIZED,\n        message: 'Invalid signature'\n      });\n    }\n  }\n//get a challenge code generated after every 3 minutes of randomly generated string. If the string is not used within 3 minutes it can be used,\n// if 3 minutes have exceeded then you issue a new challenge code\n  @UseGuards(AuthGuard('jwt'))\n  @Get('secret')\n  async getAllUsers() {\n    return await this.userService.randomSecret();\n  }\n}\n","import { AuthModule } from '@interview/auth';\nimport { UserModule } from '@interview/user';\nimport { Module } from '@nestjs/common';\nimport { DAuthController } from './d-auth.controller';\nimport { DAuthService } from './d-auth.service';\n\n@Module({\n  imports: [\n    AuthModule,\n    UserModule\n  ],\n  controllers: [DAuthController],\n  providers: [DAuthService],\n  exports: [DAuthService],\n})\nexport class DAuthModule {}\n","import { Injectable } from '@nestjs/common';\nimport { u8aToHex } from '@polkadot/util';\nimport { decodeAddress, signatureVerify } from '@polkadot/util-crypto';\nimport { PrismaClient } from '@prisma/client';\n\nconst prisma = new PrismaClient();\n\n@Injectable()\nexport class DAuthService {\n    private isValidSignature (signedMessage: string, signature: string, address: string) {\n        const publicKey = decodeAddress(address);\n        const hexPublicKey = u8aToHex(publicKey);\n//polkadot(verify if signature is valid)\n        return signatureVerify(signedMessage, signature, hexPublicKey).isValid;\n    }\n\n    public async signin(params) {\n        const { message, signature, username } = params;\n        const isValid = this.isValidSignature(message, signature, username);\n\n        return isValid;\n    }\n\n    public async signinTask3(params) {\n        const { message, signature, username, challengeCode } = params;\n        const isValid = this.isValidSignature(message, signature, username);\n\n        //check if challenge exists\n        if (isValid === true) {\n            const result = await prisma.challenge.findFirst({\n                where: {\n                    usedAt: null,\n                    requester: username,\n                    challenge: challengeCode\n                }\n            })\n\n            if (result) {\n                //update challengecode to expired\n                await prisma.challenge.update({\n                    where: {\n                        id: result.id\n                    },\n                    data: {\n                        usedAt: new Date()\n                    }\n                });\n                return true;\n            }\n        }\n\n        return false\n    }\n}\n","import { IsNotEmpty, IsString, MaxLength, MinLength } from \"class-validator\";\n\nexport class RegisterDTO {\n    @IsNotEmpty()\n    @MaxLength(100)\n    username: string;\n\n    @IsNotEmpty()\n    @IsString()\n    @MinLength(6)\n    password: string;\n\n    //validate alphanumeric, min 8 characters, max 20 characters, unique, required, no spaces, no symbols\n    \n}\n\n","export * from './lib/user.controller';\nexport * from './lib/user.service';\nexport * from './lib/user.module';\n","import { Body, Controller, Get, Post, HttpStatus, UseGuards, Res, UnauthorizedException } from '@nestjs/common';\nimport { Response } from 'express';\nimport { Prisma } from '@prisma/client';\nimport { AuthGuard } from '@nestjs/passport';\n\nimport { UserService } from './user.service';\nimport { AuthService } from '@interview/auth';\nimport { RegisterDTO } from '../dto/register.dto';\n\n@Controller('v1')// allows grouping of endpoints\nexport class UserController {\n  constructor(\n    private userService: UserService,\n    private authService: AuthService,\n  ) {}\n\n\n  async validate(username: string, password: string): Promise<any> {\n    const user = await this.authService.validateUserCredentials(username, password);\n    console.log('user', user);\n\n    if (!user) {\n        throw new UnauthorizedException('Invalid credentials, user not found');\n    }\n\n    return user;\n}\n  \n  @Post('signin')\n  async createUser(@Body() params: RegisterDTO, @Res() res: Response) {\n    const { username, password } = params;\n    // Validate if user already exists\n    const isUserU = await this.userService.findOneByUsername(username);\n    // if (isUserU) return res.status(HttpStatus.CONFLICT).json({'message': 'User already exists'});\n    if (isUserU) {\n      const user = await this.authService.validateUserCredentials(username, password);\n      if (!user) {\n        throw new UnauthorizedException('Invalid credentials, user not found');\n      }\n        const token = await this.authService.loginWithCredentials(user);\n        return res.status(HttpStatus.OK).json({\n          message: 'Login successful',\n          access_token: token,\n          user: user\n        });// Task 1- if a username exists validate and return a token. If a username is not found create a new one\n    }// destructuring parameters\n\n    // Validate user inputs\n    const validation = this.userService.validateUserInputs(params, res);\n    if(validation === true) {\n      const user = await this.userService.create(params);\n      if(!user) return res.status(HttpStatus.INTERNAL_SERVER_ERROR).json({'message': 'User could not be created'});\n      return res.status(HttpStatus.OK).json({'message': 'User created successfully'});\n    }\n  }\n\n  @UseGuards(AuthGuard('jwt'))\n  @Get('secret')\n  async getAllUsers() {\n    return await this.userService.randomSecret();\n  }\n}\n// Endpoints. ","import { AuthModule } from '@interview/auth';\nimport { Module } from '@nestjs/common';\nimport { UserController } from './user.controller';\nimport { UserService } from './user.service';\n\n@Module({\n  imports: [\n    AuthModule\n  ],\n  controllers: [UserController],\n  providers: [UserService],\n  exports: [UserService],\n})\nexport class UserModule {}\n","import { HttpStatus, Injectable } from '@nestjs/common';\nimport { Prisma, PrismaClient, User } from '@prisma/client';\nimport * as bcrypt from 'bcrypt';\nimport { Response } from 'express';\nimport { RegisterDTO } from '../dto/register.dto';\n\nconst prisma = new PrismaClient();\n\n@Injectable()\nexport class UserService {\n    public async create(params: Prisma.UserCreateInput): Promise<User> {\n        const { password } = params;       \n        \n        const hashedPassword = await bcrypt.hash(password, 10);\n        const user = await prisma.user.create({\n            data: { ...params, password: hashedPassword }\n        });\n        return user;\n    }\n\n    public async findOneByUsername(username: string): Promise<User|null> {\n        return prisma.user.findFirst({\n            where: {\n                username,\n            }\n        });\n    }  \n\n    public async randomSecret() {\n        const secrets = await prisma.secret.findMany({});\n        const randomSecret = secrets[Math.floor(Math.random() * secrets.length)];\n        return randomSecret;\n    }\n    \n    public validateUserInputs(params: RegisterDTO, res: Response) {\n        const { username, password } = params;\n        //check if password has a min length of 6 characters\n        if (password.length < 6) {\n            // throw new Error('Password must be at least 6 characters');\n            return res.status(HttpStatus.BAD_REQUEST).json({'statusCode': HttpStatus.BAD_REQUEST,'message': 'Password must be at least 6 characters'});\n        }\n        //check if username is a string\n        if (typeof username !== 'string') {\n            // throw new Error('Username must be a string');\n            return res.status(HttpStatus.BAD_REQUEST).json({'statusCode': HttpStatus.BAD_REQUEST,'message': 'Username must be a string'});\n        }\n        //check if username has symbols\n        if (username.match(/[^a-zA-Z0-9]/)) {\n            // throw new Error('Username must be alphanumeric');\n            return res.status(HttpStatus.BAD_REQUEST).json({'statusCode': HttpStatus.BAD_REQUEST,'message': 'Username must be alphanumeric'});\n        }\n        //check if username has a max length of 100 characters\n        if (username.length > 100) {\n            // throw new Error('Username must be at most 100 characters');\n            return res.status(HttpStatus.BAD_REQUEST).json({'statusCode': HttpStatus.BAD_REQUEST,'message': 'Username must be at most 100 characters'});\n        }\n        //check if username has spaces\n        if (username.match(/\\s/)) {\n            // throw new Error('Username must not contain spaces');\n            return res.status(HttpStatus.BAD_REQUEST).json({'statusCode': HttpStatus.BAD_REQUEST,'message': 'Username must not contain spaces'});\n        }\n        return true;\n    }\n}\n\n","module.exports = require(\"@nestjs/common\");","module.exports = require(\"@nestjs/core\");","module.exports = require(\"@nestjs/jwt\");","module.exports = require(\"@nestjs/passport\");","module.exports = require(\"@polkadot/util\");","module.exports = require(\"@polkadot/util-crypto\");","module.exports = require(\"@prisma/client\");","module.exports = require(\"bcrypt\");","module.exports = require(\"class-validator\");","module.exports = require(\"express\");","module.exports = require(\"passport-jwt\");","module.exports = require(\"passport-local\");","module.exports = require(\"tslib\");","// The module cache\nvar __webpack_module_cache__ = {};\n\n// The require function\nfunction __webpack_require__(moduleId) {\n\t// Check if module is in cache\n\tvar cachedModule = __webpack_module_cache__[moduleId];\n\tif (cachedModule !== undefined) {\n\t\treturn cachedModule.exports;\n\t}\n\t// Create a new module (and put it into the cache)\n\tvar module = __webpack_module_cache__[moduleId] = {\n\t\t// no module.id needed\n\t\t// no module.loaded needed\n\t\texports: {}\n\t};\n\n\t// Execute the module function\n\t__webpack_modules__[moduleId](module, module.exports, __webpack_require__);\n\n\t// Return the exports of the module\n\treturn module.exports;\n}\n\n","/**\n * This is not a production server yet!\n * This is only a minimal backend to get started.\n */\n\nimport { Logger } from '@nestjs/common';\nimport { NestFactory } from '@nestjs/core';\n\nimport { AppModule } from './app/app.module';\n\nasync function bootstrap() {\n  const app = await NestFactory.create(AppModule);\n  const globalPrefix = 'api';\n  app.setGlobalPrefix(globalPrefix);\n  const port = process.env.PORT || 4444;\n  await app.listen(port);\n  Logger.log(\n    `🚀 Application is running on: http://localhost:${port}/${globalPrefix}`\n  );\n}\n\nbootstrap();\n"],"names":[],"sourceRoot":""}